import{s as T,A as l,l as h,_ as Q,r as W,u as X,b as Z,k as $,w as aa,v as ta,P as _,x as ea,j as Y,d as u,e as G,o as i,c as s,f as e,g as r,t as k,F as I,i as C,m as p,y as f,p as ca,q as ia}from"./index-a1bff658.js";class K{constructor(n){this.campaignId=n.campaignId,this.accountId=n.accountId,this.Campaign=n.Campaign,this.Profile=n.Profile}}class sa{async getAccountCampaignLinks(n){const a=(await T.get(`api/campaigns/${n}/accountcampaignlinks`)).data.map(b=>new K(b));l.AccountLinks=a}async createAccountLink(n){const g=await T.post("api/accountcampaignlinks",n);h.log("created account link",g.data),l.AccountLinks.push(new K(g.data))}}const O=new sa;const na={setup(){W({});const o=X();Z(()=>{a(),b(),n(),g(),$.getEntity()}),aa(()=>{n(),g()});async function n(){try{const c=o.params.campaignId;await ta.getEntityLinksByCampaign(c)}catch(c){_.error(c.message),h.log(c)}}async function g(){try{const c=o.params.campaignId;await ea.getNotesByCampaign(c)}catch(c){_.error(c.message),h.log(c)}}async function a(){try{const c=o.params.campaignId;await Y.getActiveCampaign(c)}catch(c){_.error(c.message),h.log(c)}}async function b(){try{const c=o.params.campaignId;h.log("here is the campaign id on page",c),await O.getAccountCampaignLinks(c)}catch(c){_.error(c.message),h.log(c)}}return{notes:u(()=>l.Notes),campaign:u(()=>l.activeCampaign),accountLinks:u(()=>l.AccountLinks),entityLinks:u(()=>l.entityLinks),account:u(()=>l.account),formattedDate:u(()=>{var c;return(c=l.activeCampaign)==null?void 0:c.nextSessionDate.toLocaleDateString()}),hasLink:u(()=>l.AccountLinks.find(c=>c.accountId==l.account.id)),async createAccountLink(){try{const w={campaignId:o.params.campaignId};await O.createAccountLink(w)}catch(c){_.error(c.message),h.log(c)}},async archiveCampaign(){try{if(await _.confirm("Are you sure you want to archive this campaign? You will not be able to undo this.")){const c=o.params.campaignId;await Y.archiveCampaign(c)}return}catch(c){_.error(c.message)}}}}},m=o=>(ca("data-v-5120d047"),o=o(),ia(),o),oa={class:"container-fluid background"},da={class:"row"},ra={class:"col-md-2 col-12 d-flex align-items-center"},la={key:0},ma=["href"],ga=m(()=>e("img",{class:"discord",src:"https://logo.com/image-cdn/images/kts928pd/production/5b24e49fd89287ff1eb5bbc4cf93cb038c3384ef-512x512.png?w=1080&q=72",alt:""},null,-1)),_a=[ga],ua={key:1},pa=m(()=>e("img",{"data-bs-toggle":"modal","data-bs-target":"#discordUpdate",class:"discord selectable",title:"Update Discord",src:"https://static.vecteezy.com/system/resources/previews/011/912/003/original/plus-sign-icon-free-png.png",alt:""},null,-1)),ha=[pa],va={class:"col-md-8 col-12"},fa={class:"text-white text-center d-flex flex-column align-items-center pt-3"},ya={key:0},ka={key:1,class:"text-warning"},ba={class:"col-md-2 col-12 d-flex justify-content-center align-items-center"},Ia=["hidden"],Ca={class:"row"},wa={class:"col-12 d-flex justify-content-around p-4"},La=["src","alt","title"],xa={class:"row"},Aa=m(()=>e("div",{class:"col-2 order-0"},null,-1)),Sa={class:"col-12 col-md-7 rounded elevation-5 child-field order-2 order-md-1"},Ea={class:"col-12 col-md-3 bg-dark text-light text-center top-menu order-1 order-md-2"},Pa=m(()=>e("h1",{class:"selectable mt-3 text-light"},"Description",-1)),Da={class:"d-flex justify-content-around align-items-center fs-4"},Na=m(()=>e("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#notes"},"Notes",-1)),ja=["hidden"],Ba={id:"notes",class:"collapse notes-menu"},Ra={class:"d-flex justify-content-between"},Ua={key:0,class:"selectable"},Va={key:1,class:"mdi mdi-eye text-success pe-3",title:"Everybody can see this Entity"},qa={class:"d-flex justify-content-around align-items-center fs-4"},Fa=m(()=>e("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#recaps"},"Recaps",-1)),za=["hidden"],Ha={id:"recaps",class:"collapse notes-menu"},Ja={key:0,class:"selectable"},Ma={class:"d-flex justify-content-around align-items-center fs-4"},Ta=m(()=>e("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#entities"},"Entities",-1)),Ya=["hidden"],Ga={id:"entities",class:"collapse notes-menu"},Ka={class:"d-flex justify-content-between"},Oa={key:0,class:"selectable"},Qa={key:1,class:"mdi mdi-eye text-success pe-3",title:"Everybody can see this Entity"},Wa=m(()=>e("h1",{class:"selectable mt-3 text-light"},"Character",-1)),Xa=m(()=>e("h1",{class:"text-light mb-3"},"Search",-1));function Za(o,n,g,a,b,c){var L,x,A,S,E,P,D,N,j,B,R,U,V,q,F,z,H;const w=G("router-view"),v=G("router-link");return i(),s("div",oa,[e("div",da,[e("div",ra,[(L=a.campaign)!=null&&L.discordLink?(i(),s("div",la,[e("a",{href:(x=a.campaign)==null?void 0:x.discordLink},_a,8,ma)])):((A=a.campaign)==null?void 0:A.creatorId)==a.account.id?(i(),s("div",ua,ha)):r("",!0)]),e("div",va,[e("div",fa,[e("h1",null,k((S=a.campaign)==null?void 0:S.name),1),((E=a.campaign)==null?void 0:E.isArchived)==!1?(i(),s("h2",ya,"Next Session Date: "+k(a.formattedDate),1)):(i(),s("h2",ka,"This Adventure Has Ended"))])]),e("div",ba,[((P=a.campaign)==null?void 0:P.creatorId)!=a.account.id&&!a.hasLink&&((D=a.campaign)==null?void 0:D.isArchived)==!1?(i(),s("button",{key:0,class:"btn btn-outline-danger",hidden:a.hasLink||((N=a.campaign)==null?void 0:N.partyCount)>=((j=a.campaign)==null?void 0:j.capacity)||!a.account.id,onClick:n[0]||(n[0]=t=>a.createAccountLink())},"Join Us!",8,Ia)):r("",!0),((B=a.campaign)==null?void 0:B.creatorId)==a.account.id&&((R=a.campaign)==null?void 0:R.isArchived)==!1?(i(),s("button",{key:1,onClick:n[1]||(n[1]=t=>a.archiveCampaign()),class:"btn btn-outline-info"},"Delete Campaign")):r("",!0)])]),e("div",Ca,[e("div",wa,[(i(!0),s(I,null,C(a.accountLinks,t=>{var d;return i(),s("div",{key:t.id},[e("img",{class:"player-avatar img-fluid",src:(d=t.Profile)==null?void 0:d.picture,alt:t.Profile.name,title:t.Profile.name},null,8,La)])}),128))])]),e("div",xa,[Aa,e("div",Sa,[e("div",null,[p(w)])]),e("div",Ea,[e("div",null,[p(v,{to:{name:"description"}},{default:f(()=>[Pa]),_:1})]),e("div",null,[e("div",Da,[Na,a.hasLink||((U=a.campaign)==null?void 0:U.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",hidden:((V=a.campaign)==null?void 0:V.isArchived)==!0,title:"Create a new Note",type:"button","data-bs-toggle":"modal","data-bs-target":"#createNote"},null,8,ja)):r("",!0)]),e("div",Ba,[(i(!0),s(I,null,C(a.notes,t=>{var d;return i(),s("ul",{class:"",key:t==null?void 0:t.id},[p(v,{to:{name:"notes",params:{campaignId:(d=a.campaign)==null?void 0:d.id,noteId:t==null?void 0:t.id}}},{default:f(()=>{var y;return[e("div",Ra,[t.isRecap==!1?(i(),s("li",Ua,k(t.name),1)):r("",!0),(t==null?void 0:t.accountId)==((y=a.account)==null?void 0:y.id)&&(t==null?void 0:t.isRecap)==!1?(i(),s("i",Va)):r("",!0)])]}),_:2},1032,["to"])])}),128))])]),e("div",null,[e("div",qa,[Fa,((q=a.campaign)==null?void 0:q.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",title:"Create a new Recap",hidden:((F=a.campaign)==null?void 0:F.isArchived)==!0,type:"button","data-bs-toggle":"modal","data-bs-target":"#createRecap"},null,8,za)):r("",!0)]),e("div",Ha,[(i(!0),s(I,null,C(a.notes,t=>{var d;return i(),s("ul",{key:t.id},[p(v,{to:{name:"notes",params:{campaignId:(d=a.campaign)==null?void 0:d.id,noteId:t==null?void 0:t.id}}},{default:f(()=>[t.isRecap==!0?(i(),s("li",Ja,k(t.name),1)):r("",!0)]),_:2},1032,["to"])])}),128))])]),e("div",null,[e("div",Ma,[Ta,((z=a.campaign)==null?void 0:z.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",title:"Add an Entity",hidden:((H=a.campaign)==null?void 0:H.isArchived)==!0,type:"button","data-bs-toggle":"modal","data-bs-target":"#addEntity"},null,8,Ya)):r("",!0)]),e("div",Ga,[(i(!0),s(I,null,C(a.entityLinks,t=>{var d;return i(),s("ul",{key:t.id},[p(v,{to:{name:"entities",params:{campaignId:(d=a.campaign)==null?void 0:d.id,entityId:t==null?void 0:t.id}}},{default:f(()=>{var y,J,M;return[e("div",Ka,[(t==null?void 0:t.isPrivate)==!1||((y=a.campaign)==null?void 0:y.creatorId)==((J=a.account)==null?void 0:J.id)?(i(),s("li",Oa,k(t.Entity.name),1)):r("",!0),t.isPrivate==!1&&((M=a.campaign)==null?void 0:M.creatorId)==a.account.id?(i(),s("i",Qa)):r("",!0)])]}),_:2},1032,["to"])])}),128))])]),e("div",null,[p(v,{to:{name:"character"}},{default:f(()=>[Wa]),_:1})]),e("div",null,[p(v,{to:{name:"search"}},{default:f(()=>[Xa]),_:1})])])])])}const at=Q(na,[["render",Za],["__scopeId","data-v-5120d047"]]);export{at as default};
