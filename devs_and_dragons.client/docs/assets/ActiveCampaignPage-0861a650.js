import{s as G,A as l,l as p,_ as X,r as Z,u as $,b as aa,k as ta,w as ea,v as ca,P as _,x as ia,j as K,d as u,e as O,o as i,c as s,f as e,g as d,t as k,F as I,i as C,m as h,y as f,p as sa,q as na}from"./index-5bccb66b.js";class Q{constructor(n){this.campaignId=n.campaignId,this.accountId=n.accountId,this.Campaign=n.Campaign,this.Profile=n.Profile}}class oa{async getAccountCampaignLinks(n){const a=(await G.get(`api/campaigns/${n}/accountcampaignlinks`)).data.map(b=>new Q(b));l.AccountLinks=a}async createAccountLink(n){const g=await G.post("api/accountcampaignlinks",n);p.log("created account link",g.data),l.AccountLinks.push(new Q(g.data))}}const W=new oa;const da={setup(){Z({});const o=$();aa(()=>{a(),b(),n(),g(),ta.getEntity()}),ea(()=>{n(),g()});async function n(){try{const c=o.params.campaignId;await ca.getEntityLinksByCampaign(c)}catch(c){_.error(c.message),p.log(c)}}async function g(){try{const c=o.params.campaignId;await ia.getNotesByCampaign(c)}catch(c){_.error(c.message),p.log(c)}}async function a(){try{const c=o.params.campaignId;await K.getActiveCampaign(c)}catch(c){_.error(c.message),p.log(c)}}async function b(){try{const c=o.params.campaignId;p.log("here is the campaign id on page",c),await W.getAccountCampaignLinks(c)}catch(c){_.error(c.message),p.log(c)}}return{notes:u(()=>l.Notes),campaign:u(()=>l.activeCampaign),accountLinks:u(()=>l.AccountLinks),entityLinks:u(()=>l.entityLinks),account:u(()=>l.account),formattedDate:u(()=>{var c;return(c=l.activeCampaign)==null?void 0:c.nextSessionDate.toLocaleDateString()}),hasLink:u(()=>l.AccountLinks.find(c=>c.accountId==l.account.id)),async createAccountLink(){try{const L={campaignId:o.params.campaignId};await W.createAccountLink(L)}catch(c){_.error(c.message),p.log(c)}},async archiveCampaign(){try{if(await _.confirm("Are you sure you want to archive this campaign? You will not be able to undo this.")){const c=o.params.campaignId;await K.archiveCampaign(c)}return}catch(c){_.error(c.message)}}}}},m=o=>(sa("data-v-9c17d555"),o=o(),na(),o),ra={class:"container-fluid background"},la={class:"row"},ma={class:"col-md-2 col-12 d-flex align-items-center"},ga={key:0},_a=["href"],ua=m(()=>e("img",{class:"discord",src:"https://logo.com/image-cdn/images/kts928pd/production/5b24e49fd89287ff1eb5bbc4cf93cb038c3384ef-512x512.png?w=1080&q=72",alt:""},null,-1)),ha=[ua],pa={key:1},va=m(()=>e("img",{"data-bs-toggle":"modal","data-bs-target":"#discordUpdate",class:"discord selectable",title:"Update Discord",src:"https://static.vecteezy.com/system/resources/previews/011/912/003/original/plus-sign-icon-free-png.png",alt:""},null,-1)),fa=[va],ya={class:"col-md-8 col-12"},ka={class:"text-white text-center d-flex flex-column align-items-center pt-3"},ba={key:0},Ia={key:1,class:"text-warning"},Ca={class:"col-md-2 col-12 d-flex justify-content-center align-items-center"},La=["hidden"],wa={class:"row"},Aa={class:"col-12 d-flex justify-content-around p-4"},xa=["src","alt","title"],Sa={class:"row"},Ea=m(()=>e("div",{class:"col-2 order-0"},null,-1)),Pa={class:"col-12 col-md-7 rounded elevation-5 child-field order-2 order-md-1"},Da={class:"col-12 col-md-3 bg-dark text-light text-center top-menu order-1 order-md-2"},Na=m(()=>e("h1",{class:"selectable mt-3 text-light"},"Description",-1)),ja={class:"d-flex justify-content-around align-items-center fs-4"},Ba=m(()=>e("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#notes"},"Notes",-1)),Ra=["hidden"],Ua={id:"notes",class:"collapse notes-menu"},Va={class:"d-flex justify-content-between"},qa={key:0,class:"selectable"},Fa={key:1,class:"mdi mdi-eye text-success pe-3",title:"Everybody can see this Entity"},za={class:"d-flex justify-content-around align-items-center fs-4"},Ha=m(()=>e("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#recaps"},"Recaps",-1)),Ja=["hidden"],Ma={id:"recaps",class:"collapse notes-menu"},Ta={key:0,class:"selectable"},Ya={class:"d-flex justify-content-around align-items-center fs-4"},Ga=m(()=>e("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#entities"},"Entities",-1)),Ka=["hidden"],Oa={id:"entities",class:"collapse notes-menu"},Qa={class:"d-flex justify-content-between"},Wa={key:0,class:"selectable"},Xa={key:1,class:"mdi mdi-eye text-success pe-3",title:"Everybody can see this Entity"},Za={class:"d-flex justify-content-around align-items-center fs-4"},$a=m(()=>e("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#characters"},"Characters",-1)),at=["hidden"],tt=m(()=>e("h1",{class:"text-light mb-3"},"Search",-1));function et(o,n,g,a,b,c){var w,A,x,S,E,P,D,N,j,B,R,U,V,q,F,z,H,J,M;const L=O("router-view"),v=O("router-link");return i(),s("div",ra,[e("div",la,[e("div",ma,[(w=a.campaign)!=null&&w.discordLink?(i(),s("div",ga,[e("a",{href:(A=a.campaign)==null?void 0:A.discordLink},ha,8,_a)])):((x=a.campaign)==null?void 0:x.creatorId)==a.account.id?(i(),s("div",pa,fa)):d("",!0)]),e("div",ya,[e("div",ka,[e("h1",null,k((S=a.campaign)==null?void 0:S.name),1),((E=a.campaign)==null?void 0:E.isArchived)==!1?(i(),s("h2",ba,"Next Session Date: "+k(a.formattedDate),1)):(i(),s("h2",Ia,"This Adventure Has Ended"))])]),e("div",Ca,[((P=a.campaign)==null?void 0:P.creatorId)!=a.account.id&&!a.hasLink&&((D=a.campaign)==null?void 0:D.isArchived)==!1?(i(),s("button",{key:0,class:"btn btn-outline-danger",hidden:a.hasLink||((N=a.campaign)==null?void 0:N.partyCount)>=((j=a.campaign)==null?void 0:j.capacity)||!a.account.id,onClick:n[0]||(n[0]=t=>a.createAccountLink())},"Join Us!",8,La)):d("",!0),((B=a.campaign)==null?void 0:B.creatorId)==a.account.id&&((R=a.campaign)==null?void 0:R.isArchived)==!1?(i(),s("button",{key:1,onClick:n[1]||(n[1]=t=>a.archiveCampaign()),class:"btn btn-outline-info"},"Delete Campaign")):d("",!0)])]),e("div",wa,[e("div",Aa,[(i(!0),s(I,null,C(a.accountLinks,t=>{var r;return i(),s("div",{key:t.id},[e("img",{class:"player-avatar img-fluid",src:(r=t.Profile)==null?void 0:r.picture,alt:t.Profile.name,title:t.Profile.name},null,8,xa)])}),128))])]),e("div",Sa,[Ea,e("div",Pa,[e("div",null,[h(L)])]),e("div",Da,[e("div",null,[h(v,{to:{name:"description"}},{default:f(()=>[Na]),_:1})]),e("div",null,[e("div",ja,[Ba,a.hasLink||((U=a.campaign)==null?void 0:U.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",hidden:((V=a.campaign)==null?void 0:V.isArchived)==!0,title:"Create a new Note",type:"button","data-bs-toggle":"modal","data-bs-target":"#createNote"},null,8,Ra)):d("",!0)]),e("div",Ua,[(i(!0),s(I,null,C(a.notes,t=>{var r;return i(),s("ul",{class:"",key:t==null?void 0:t.id},[h(v,{to:{name:"notes",params:{campaignId:(r=a.campaign)==null?void 0:r.id,noteId:t==null?void 0:t.id}}},{default:f(()=>{var y;return[e("div",Va,[t.isRecap==!1?(i(),s("li",qa,k(t.name),1)):d("",!0),(t==null?void 0:t.accountId)==((y=a.account)==null?void 0:y.id)&&(t==null?void 0:t.isRecap)==!1?(i(),s("i",Fa)):d("",!0)])]}),_:2},1032,["to"])])}),128))])]),e("div",null,[e("div",za,[Ha,((q=a.campaign)==null?void 0:q.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",title:"Create a new Recap",hidden:((F=a.campaign)==null?void 0:F.isArchived)==!0,type:"button","data-bs-toggle":"modal","data-bs-target":"#createRecap"},null,8,Ja)):d("",!0)]),e("div",Ma,[(i(!0),s(I,null,C(a.notes,t=>{var r;return i(),s("ul",{key:t.id},[h(v,{to:{name:"notes",params:{campaignId:(r=a.campaign)==null?void 0:r.id,noteId:t==null?void 0:t.id}}},{default:f(()=>[t.isRecap==!0?(i(),s("li",Ta,k(t.name),1)):d("",!0)]),_:2},1032,["to"])])}),128))])]),e("div",null,[e("div",Ya,[Ga,((z=a.campaign)==null?void 0:z.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",title:"Add an Entity",hidden:((H=a.campaign)==null?void 0:H.isArchived)==!0,type:"button","data-bs-toggle":"modal","data-bs-target":"#addEntity"},null,8,Ka)):d("",!0)]),e("div",Oa,[(i(!0),s(I,null,C(a.entityLinks,t=>{var r;return i(),s("ul",{key:t.id},[h(v,{to:{name:"entities",params:{campaignId:(r=a.campaign)==null?void 0:r.id,entityId:t==null?void 0:t.id}}},{default:f(()=>{var y,T,Y;return[e("div",Qa,[(t==null?void 0:t.isPrivate)==!1||((y=a.campaign)==null?void 0:y.creatorId)==((T=a.account)==null?void 0:T.id)?(i(),s("li",Wa,k(t.Entity.name),1)):d("",!0),t.isPrivate==!1&&((Y=a.campaign)==null?void 0:Y.creatorId)==a.account.id?(i(),s("i",Xa)):d("",!0)])]}),_:2},1032,["to"])])}),128))])]),e("div",null,[e("div",Za,[h(v,{to:{name:"character"}},{default:f(()=>[$a]),_:1}),a.hasLink||((J=a.campaign)==null?void 0:J.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",hidden:((M=a.campaign)==null?void 0:M.isArchived)==!0,title:"Add a Player Character",type:"button","data-bs-toggle":"modal","data-bs-target":"#createCharacter"},null,8,at)):d("",!0)])])]),e("div",null,[h(v,{to:{name:"search"}},{default:f(()=>[tt]),_:1})])])])}const it=X(da,[["render",et],["__scopeId","data-v-9c17d555"]]);export{it as default};
